build:
  builder: NIXPACKS
  nixpacksConfigPath: nixpacks.toml
  context: .
  dockerfile: dockerfile

deploy:
  startCommand: node index.js
  
  numReplicas: 1
  
  restartPolicyType: ON_FAILURE
  restartPolicyMaxRetries: 3
  
variables:
  NODE_ENV: production
  VITE_SUPABASE_URL: ${{SUPABASE_URL}}
  VITE_SUPABASE_ANON_KEY: ${{SUPABASE_ANON_KEY}}

healthcheckTimeout: 300

regions:
  - europe-west4-drams3a