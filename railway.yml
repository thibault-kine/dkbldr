build:
  builder: NIXPACKS
  buildCommand: npm run build
  nixpacksConfigPath: nixpacks.toml

deploy:
  startCommand: echo "Starting on port $PORT" && npx serve -s dist -p $PORT
  
  numReplicas: 1
  
  restartPolicyType: ON_FAILURE
  restartPolicyMaxRetries: 3
  
variables:
  NODE_ENV: production
  VITE_SUPABASE_URL: ${{VITE_SUPABASE_URL}}
  VITE_SUPABASE_ANON_KEY: ${{VITE_SUPABASE_ANON_KEY}}

healthcheckTimeout: 300

regions:
  - us-west1